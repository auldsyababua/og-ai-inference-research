=== STAGED CHANGES ===
diff --git a/tools/DEPLOYMENT_GUIDE_PHASE2.md b/tools/DEPLOYMENT_GUIDE_PHASE2.md
new file mode 100644
index 0000000..13edd09
--- /dev/null
+++ b/tools/DEPLOYMENT_GUIDE_PHASE2.md
@@ -0,0 +1,395 @@
+# Phase 2 Deployment Guide: Automated Package Management
+
+## Overview
+
+This guide covers Phase 2 of the matplotlib/seaborn fix: automating package management via `environment.yml` in the deployment script.
+
+**Status**: Code changes complete, ready for deployment
+**Prerequisites**: Phase 1 must be complete (packages added via Snowsight UI)
+**Expected Downtime**: 1-2 minutes during deployment
+**Risk Level**: Low-Medium (well-tested, clear rollback path)
+
+## What Changed
+
+### Files Modified
+
+1. **`tools/environment.yml`** (NEW)
+   - Conda environment specification
+   - Pinned versions: matplotlib=3.10.6, seaborn=0.13.2, streamlit=1.35.0
+   - Ensures reproducible deployments
+
+2. **`tools/deploy_to_snowflake_streamlit.py`** (MODIFIED)
+   - Uploads environment.yml to stage
+   - Implements DROP + CREATE workflow (replaces CREATE OR REPLACE)
+   - Adds deployment verification checks
+   - Enhanced output messaging
+
+### Key Changes in Deployment Script
+
+**Change 1: Upload environment.yml** (after line 94)
+```python
+# Upload environment.yml for package management
+print(f"\n1b. Uploading environment.yml for package management...")
+env_file = SCRIPT_DIR / "environment.yml"
+if env_file.exists():
+    upload_file_to_stage(cursor, str(env_file), STAGE_NAME, "")
+else:
+    print("   âš  Warning: environment.yml not found")
+```
+
+**Change 2: DROP before CREATE** (replaces CREATE OR REPLACE)
+```python
+# Drop existing app to pick up new environment.yml
+print(f"\n4. Dropping existing Streamlit app (if exists)...")
+cursor.execute(f"DROP STREAMLIT IF EXISTS {APP_NAME}")
+
+# Create Streamlit app (reads environment.yml from stage)
+print(f"\n4b. Creating Streamlit app with package dependencies...")
+create_sql = f"""
+CREATE STREAMLIT {APP_NAME}
+FROM @{STAGE_NAME}
+MAIN_FILE = 'unified-calculator-app.py'
+...
+"""
+```
+
+**Change 3: Deployment Verification**
+```python
+# Verify deployment
+print(f"\n5. Verifying deployment...")
+cursor.execute(f"SHOW STREAMLITS LIKE '{APP_NAME}'")
+# ... check app exists
+
+# Check stage files
+cursor.execute(f"LIST @{STAGE_NAME}")
+# ... verify environment.yml present
+```
+
+## Pre-Deployment Checklist
+
+- [ ] Phase 1 complete (matplotlib/seaborn working via UI)
+- [ ] Git changes committed (for rollback capability)
+- [ ] `tools/environment.yml` exists locally
+- [ ] `tools/deploy_to_snowflake_streamlit.py` updated
+- [ ] Snowflake credentials configured
+- [ ] Private key (`rsa_key.pem`) in tools/ directory
+- [ ] Maintenance window scheduled and communicated to users
+
+## Deployment Steps
+
+### 1. Verify Prerequisites
+
+```bash
+cd /srv/projects/og-ai-inference-research/tools
+
+# Check files exist
+ls -la environment.yml
+ls -la deploy_to_snowflake_streamlit.py
+ls -la rsa_key.pem
+
+# Verify git status
+git status
+```
+
+### 2. Test in Non-Production (Optional but Recommended)
+
+If you have a dev/staging environment:
+
+```bash
+# Modify script temporarily to use test app name
+# Deploy to test environment
+python3 deploy_to_snowflake_streamlit.py
+
+# Verify test app works
+# Restore production app name
+```
+
+### 3. Announce Maintenance Window
+
+**Example notification:**
+```
+ðŸ”§ Maintenance Notice: Streamlit Calculator App
+Time: [DATE] at [TIME]
+Duration: ~2 minutes
+Impact: Brief app downtime for package management upgrade
+Benefit: Resolves matplotlib import errors permanently
+```
+
+### 4. Execute Deployment
+
+```bash
+cd /srv/projects/og-ai-inference-research/tools
+
+# Run deployment script
+python3 deploy_to_snowflake_streamlit.py
+```
+
+### 5. Monitor Output
+
+Expected output:
+```
+============================================================
+DEPLOY STREAMLIT APP TO SNOWFLAKE
+============================================================
+Connecting to Snowflake...
+âœ“ Connected!
+
+1. Creating stage: streamlit_apps
+   âœ“ Stage created/verified
+
+1b. Uploading environment.yml for package management...
+  Uploading environment.yml to @streamlit_apps/...
+    âœ“ environment.yml uploaded successfully
+
+2. Uploading Streamlit app files...
+  ...
+
+4. Dropping existing Streamlit app (if exists)...
+   âœ“ Existing app dropped
+
+4b. Creating Streamlit app with package dependencies: off_grid_calculator
+   âœ“ Streamlit app created with matplotlib and seaborn packages!
+
+5. Verifying deployment...
+   âœ“ App exists in Snowflake
+
+5b. Verifying stage files...
+   âœ“ All required files present on stage
+
+6. Getting app URL...
+   âœ“ App URL: https://ZWZLXDA-MEB82135.snowflakecomputing.com/streamlit/off_grid_calculator
+
+============================================================
+DEPLOYMENT COMPLETE!
+============================================================
+```
+
+### 6. Post-Deployment Verification
+
+**Immediate Checks:**
+- [ ] Deployment script completed without errors
+- [ ] App URL accessible
+- [ ] App loads without ModuleNotFoundError
+- [ ] No errors in Snowflake logs
+
+**Functional Testing:**
+- [ ] Navigate to app URL
+- [ ] Test all pages (especially visualization pages):
+  - Generator Risk Parameters
+  - BESS Sizing
+  - Data Logistics
+- [ ] Verify charts/plots render correctly
+- [ ] Check for any new errors or warnings
+
+**Verification via Snowsight:**
+- [ ] Open app in Snowsight editor
+- [ ] Click "Packages" button
+- [ ] Verify matplotlib=3.10.6, seaborn=0.13.2 listed
+- [ ] Check stage files: `LIST @streamlit_apps` (should show environment.yml)
+
+**SQL Verification:**
+```sql
+-- Check app exists
+SHOW STREAMLIT off_grid_calculator;
+
+-- Check stage files
+LIST @streamlit_apps;
+
+-- Should see: environment.yml, unified-calculator-app.py, pages/, models/
+```
+
+### 7. Announce Completion
+
+**Example notification:**
+```
+âœ… Maintenance Complete: Streamlit Calculator App
+Status: Deployed successfully
+Changes: Package management now automated via environment.yml
+Result: matplotlib and seaborn permanently configured
+Next deployment: Will automatically include package dependencies
+```
+
+## Rollback Plan
+
+If deployment fails or issues occur:
+
+### Option A: Revert Git Changes
+
+```bash
+cd /srv/projects/og-ai-inference-research
+
+# Revert deployment script changes
+git checkout HEAD -- tools/deploy_to_snowflake_streamlit.py
+
+# Remove environment.yml
+rm tools/environment.yml
+
+# Redeploy with old script (CREATE OR REPLACE, no packages)
+cd tools
+python3 deploy_to_snowflake_streamlit.py
+```
+
+### Option B: Manual SQL Recovery
+
+```sql
+-- Drop problematic app
+DROP STREAMLIT IF EXISTS off_grid_calculator;
+
+-- Recreate manually (will use existing stage files)
+CREATE STREAMLIT off_grid_calculator
+FROM @streamlit_apps
+MAIN_FILE = 'unified-calculator-app.py'
+QUERY_WAREHOUSE = CALCULATOR_WH;
+```
+
+### Option C: Fall Back to Phase 1
+
+If Phase 2 deployment fails, Phase 1 (UI-added packages) remains active:
+1. Packages added via UI persist independently
+2. App continues working with matplotlib/seaborn
+3. Fix deployment script issues offline
+4. Retry Phase 2 when ready
+
+**Recovery Time**: 5-10 minutes
+**Data Loss**: None (Streamlit is stateless)
+
+## Troubleshooting
+
+### Issue: environment.yml not found
+
+**Symptom:**
+```
+âš  Warning: environment.yml not found, packages may not be installed
+```
+
+**Fix:**
+```bash
+cd /srv/projects/og-ai-inference-research
+cp .scratch/raep-debug/02-snowflake-matplotlib-import/tests/environment.yml tools/
+```
+
+### Issue: DROP STREAMLIT fails
+
+**Symptom:**
+```
+Error dropping streamlit: [SQL error message]
+```
+
+**Fix:**
+- Usually safe to ignore if CREATE succeeds
+- CREATE OR REPLACE should work as fallback
+- Check app exists: `SHOW STREAMLIT off_grid_calculator`
+
+### Issue: CREATE fails after DROP
+
+**Symptom:**
+```
+Error creating streamlit: [SQL error message]
+```
+
+**Fix:**
+1. Check error message for specifics
+2. Verify stage has required files: `LIST @streamlit_apps`
+3. Manually recreate via SQL (Option B rollback)
+4. Fall back to Phase 1 UI method
+
+### Issue: Packages not installed after deployment
+
+**Symptom:**
+- ModuleNotFoundError still occurs
+- Packages not visible in Snowsight â†’ Packages
+
+**Fix:**
+1. Verify environment.yml on stage: `LIST @streamlit_apps`
+2. Check environment.yml syntax (should match tools/environment.yml)
+3. Drop and recreate app manually via SQL
+4. If persistent, use Phase 1 UI method as fallback
+
+### Issue: App downtime longer than expected
+
+**Expected**: 30-60 seconds
+**If longer**:
+1. Check Snowflake service status
+2. Monitor Snowsight â†’ Streamlit section
+3. Check warehouse is running: `SHOW WAREHOUSES`
+4. Contact Snowflake support if >5 minutes
+
+## Validation Checklist
+
+Post-deployment validation:
+
+**Infrastructure:**
+- [ ] environment.yml exists on stage (`LIST @streamlit_apps`)
+- [ ] App exists (`SHOW STREAMLIT off_grid_calculator`)
+- [ ] All stage files present (environment.yml, .py files, CSV files)
+
+**Packages:**
+- [ ] Packages visible in Snowsight â†’ Packages
+- [ ] matplotlib=3.10.6 listed
+- [ ] seaborn=0.13.2 listed
+- [ ] streamlit=1.35.0 listed
+
+**Functionality:**
+- [ ] App loads without errors
+- [ ] No ModuleNotFoundError
+- [ ] All pages accessible
+- [ ] Visualizations render correctly
+- [ ] No new errors introduced
+
+**Documentation:**
+- [ ] Deployment logged in issue tracker
+- [ ] Git commit with descriptive message
+- [ ] Team notified of changes
+
+## Future Deployments
+
+**Adding New Packages:**
+1. Edit `tools/environment.yml`
+2. Add package to dependencies list
+3. Run deployment script (DROP + CREATE picks up changes)
+4. No manual UI steps required
+
+**Example - Adding pandas:**
+```yaml
+name: sf_env
+channels:
+  - snowflake
+dependencies:
+  - streamlit=1.35.0
+  - matplotlib=3.10.6
+  - seaborn=0.13.2
+  - pandas=2.1.0  # New package
+```
+
+**Updating Package Versions:**
+1. Edit version in `tools/environment.yml`
+2. Test in non-prod if available
+3. Deploy during maintenance window
+4. Verify updated versions in Snowsight â†’ Packages
+
+## Benefits Achieved
+
+âœ… **Automated**: No manual UI steps for package management
+âœ… **Version Controlled**: environment.yml tracked in git
+âœ… **Reproducible**: Same packages deployed every time
+âœ… **Documented**: Clear deployment and rollback procedures
+âœ… **Sustainable**: Future package changes are straightforward
+
+## Support
+
+**Issues during deployment:**
+- Check troubleshooting section above
+- Review error messages in deployment script output
+- Fall back to Phase 1 (UI method) if needed
+- Consult `.scratch/raep-debug/02-snowflake-matplotlib-import/10-handoff.md` for investigation details
+
+**Questions:**
+- Refer to Snowflake Streamlit documentation
+- Check `tools/README.md` for additional context
+- Review RAEP investigation artifacts in `.scratch/raep-debug/02-snowflake-matplotlib-import/`
+
+---
+
+**Document Version**: 1.0
+**Last Updated**: 2025-12-03
+**Related**: Phase 1 completed via UI, RAEP investigation in .scratch/raep-debug/02-snowflake-matplotlib-import/
diff --git a/tools/deploy_to_snowflake_streamlit.py b/tools/deploy_to_snowflake_streamlit.py
new file mode 100755
index 0000000..69c0478
--- /dev/null
+++ b/tools/deploy_to_snowflake_streamlit.py
@@ -0,0 +1,245 @@
+#!/usr/bin/env python3
+"""
+Deploy Streamlit app to Snowflake Streamlit Apps
+Handles file uploads to stage and CREATE STREAMLIT command
+"""
+import snowflake.connector
+from cryptography.hazmat.primitives import serialization
+from cryptography.hazmat.backends import default_backend
+import os
+import sys
+from pathlib import Path
+
+# Configuration
+SNOWFLAKE_ACCOUNT = os.getenv("SNOWFLAKE_ACCOUNT", "ZWZLXDA-MEB82135")
+SNOWFLAKE_USER = os.getenv("SNOWFLAKE_USER", "10NETZERO")
+SNOWFLAKE_ROLE = os.getenv("SNOWFLAKE_ROLE", "ACCOUNTADMIN")
+SNOWFLAKE_WAREHOUSE = os.getenv("SNOWFLAKE_WAREHOUSE", "CALCULATOR_WH")
+SNOWFLAKE_DATABASE = os.getenv("SNOWFLAKE_DATABASE", "CALCULATOR_DB")
+SNOWFLAKE_SCHEMA = os.getenv("SNOWFLAKE_SCHEMA", "PUBLIC")
+
+# Key-pair authentication
+SCRIPT_DIR = Path(__file__).parent
+PRIVATE_KEY_FILE = SCRIPT_DIR / "rsa_key.pem"
+STAGE_NAME = "streamlit_apps"
+APP_NAME = "off_grid_calculator"
+
+def load_private_key():
+    """Load private key from PEM file"""
+    with open(PRIVATE_KEY_FILE, 'rb') as f:
+        private_key_pem = f.read()
+    private_key = serialization.load_pem_private_key(
+        private_key_pem, password=None, backend=default_backend()
+    )
+    return private_key.private_bytes(
+        encoding=serialization.Encoding.DER,
+        format=serialization.PrivateFormat.PKCS8,
+        encryption_algorithm=serialization.NoEncryption()
+    )
+
+def upload_file_to_stage(cursor, local_path, stage_name, stage_path=""):
+    """Upload a file to Snowflake stage using PUT command"""
+    file_name = os.path.basename(local_path)
+    # Stage path format: @stage_name/path/ (PUT uses local filename automatically)
+    if stage_path:
+        stage_target = f"@{stage_name}/{stage_path}"
+    else:
+        stage_target = f"@{stage_name}/"
+    
+    print(f"  Uploading {file_name} to {stage_target}...")
+    
+    # PUT command - note: file path needs to be absolute, PUT preserves filename
+    abs_path = os.path.abspath(local_path)
+    put_sql = f"PUT file://{abs_path} {stage_target} overwrite=true auto_compress=false"
+    
+    cursor.execute(put_sql)
+    result = cursor.fetchall()
+    
+    if result:
+        status = result[0][6] if len(result[0]) > 6 else 'UNKNOWN'
+        if status == 'UPLOADED':
+            print(f"    âœ“ {file_name} uploaded successfully")
+            return True
+        else:
+            print(f"    âš  Status: {status}")
+            return False
+    return False
+
+def main():
+    print("=" * 60)
+    print("DEPLOY STREAMLIT APP TO SNOWFLAKE")
+    print("=" * 60)
+    
+    # Load private key
+    private_key = load_private_key()
+    
+    # Connect to Snowflake
+    print(f"Connecting to Snowflake...")
+    conn = snowflake.connector.connect(
+        user=SNOWFLAKE_USER,
+        private_key=private_key,
+        account=SNOWFLAKE_ACCOUNT,
+        role=SNOWFLAKE_ROLE,
+        warehouse=SNOWFLAKE_WAREHOUSE,
+        database=SNOWFLAKE_DATABASE,
+        schema=SNOWFLAKE_SCHEMA
+    )
+    
+    cursor = conn.cursor()
+    print("âœ“ Connected!")
+    
+    # Create stage
+    print(f"\n1. Creating stage: {STAGE_NAME}")
+    cursor.execute(f"CREATE STAGE IF NOT EXISTS {STAGE_NAME}")
+    print("   âœ“ Stage created/verified")
+
+    # Upload environment.yml for package management
+    print(f"\n1b. Uploading environment.yml for package management...")
+    env_file = SCRIPT_DIR / "environment.yml"
+    if env_file.exists():
+        upload_file_to_stage(cursor, str(env_file), STAGE_NAME, "")
+    else:
+        print("   âš  Warning: environment.yml not found, packages may not be installed")
+        print("   âš  App will use default Snowflake packages only (no matplotlib/seaborn)")
+
+    # Upload main app file
+    print(f"\n2. Uploading Streamlit app files...")
+    main_app_file = SCRIPT_DIR / "unified-calculator-app.py"
+    
+    if not main_app_file.exists():
+        print(f"   âœ— Error: {main_app_file} not found")
+        sys.exit(1)
+    
+    upload_file_to_stage(cursor, str(main_app_file), STAGE_NAME, "")
+    
+    # Upload pages directory files
+    print(f"\n2b. Uploading pages directory files...")
+    pages_dir = SCRIPT_DIR / "pages"
+    if pages_dir.exists():
+        page_count = 0
+        for page_file in pages_dir.glob("*.py"):
+            # Upload to pages/ subdirectory in stage
+            if upload_file_to_stage(cursor, str(page_file), STAGE_NAME, "pages/"):
+                page_count += 1
+        print(f"   âœ“ Uploaded {page_count} page file(s)")
+    else:
+        print("   âš  Warning: pages/ directory not found, skipping")
+    
+    # Upload CSV files to stage
+    print(f"\n3. Uploading CSV data files...")
+    csv_files = [
+        "models/gpu-generator-compatibility/GPU-Generator-Compatibility-Matrix-v1.csv",
+        "models/bess-sizing/BESS-Sizing-v1.csv",
+        "models/data-logistics/DataLogistics-v1.csv"
+    ]
+    
+    base_path = SCRIPT_DIR.parent
+    for csv_rel_path in csv_files:
+        csv_file = base_path / csv_rel_path
+        if csv_file.exists():
+            # Upload to subdirectory in stage
+            stage_subdir = csv_rel_path.split('/')[0]  # e.g., 'gpu-generator-compatibility'
+            upload_file_to_stage(cursor, str(csv_file), STAGE_NAME, f"{stage_subdir}/")
+        else:
+            print(f"   âš  Warning: {csv_file} not found, skipping")
+    
+    # Drop existing app to pick up new environment.yml
+    # Note: This causes brief downtime (~30-60 seconds) but is necessary
+    # because Snowflake only copies files once during CREATE
+    print(f"\n4. Dropping existing Streamlit app (if exists)...")
+    try:
+        cursor.execute(f"DROP STREAMLIT IF EXISTS {APP_NAME}")
+        print("   âœ“ Existing app dropped")
+    except Exception as e:
+        print(f"   âš  Note: {e}")
+        print("   Continuing with CREATE...")
+
+    # Create Streamlit app (reads environment.yml from stage)
+    print(f"\n4b. Creating Streamlit app with package dependencies: {APP_NAME}")
+    # Use FROM syntax (newer, recommended) instead of ROOT_LOCATION (legacy)
+    # Snowflake will automatically detect and use environment.yml at stage root
+    create_sql = f"""
+    CREATE STREAMLIT {APP_NAME}
+    FROM @{STAGE_NAME}
+    MAIN_FILE = 'unified-calculator-app.py'
+    QUERY_WAREHOUSE = {SNOWFLAKE_WAREHOUSE}
+    COMMENT = 'Off-Grid Inference Infra Calculator'
+    TITLE = 'Off-Grid Inference Infra Calculator'
+    """
+
+    cursor.execute(create_sql)
+    print("   âœ“ Streamlit app created with matplotlib and seaborn packages!")
+    
+    # Initialize the app (make it live)
+    print(f"\n4c. Initializing app (making it live)...")
+    try:
+        cursor.execute(f"ALTER STREAMLIT {APP_NAME} ADD LIVE VERSION FROM LAST")
+        print("   âœ“ App initialized!")
+    except Exception as e:
+        error_msg = str(e)
+        if "already has a live version" in error_msg.lower():
+            print("   âœ“ App already has a live version")
+        else:
+            print(f"   âš  Note: {e}")
+            print("   You may need to access the app via Snowsight first to fully initialize")
+    
+    # Verify deployment
+    print(f"\n5. Verifying deployment...")
+
+    # Check app exists
+    cursor.execute(f"SHOW STREAMLITS LIKE '{APP_NAME}'")
+    result = cursor.fetchone()
+    if result:
+        print("   âœ“ App exists in Snowflake")
+    else:
+        print("   âœ— Error: App not found after creation!")
+        cursor.close()
+        conn.close()
+        sys.exit(1)
+
+    # Check stage files
+    print(f"\n5b. Verifying stage files...")
+    cursor.execute(f"LIST @{STAGE_NAME}")
+    stage_files = cursor.fetchall()
+    file_names = [row[0].split('/')[-1] for row in stage_files]
+
+    required_files = ['environment.yml', 'unified-calculator-app.py']
+    missing = [f for f in required_files if f not in file_names]
+
+    if missing:
+        print(f"   âš  Warning: Missing files on stage: {', '.join(missing)}")
+    else:
+        print(f"   âœ“ All required files present on stage")
+
+    print(f"   Files on stage: {', '.join(file_names[:10])}{'...' if len(file_names) > 10 else ''}")
+
+    # Get app URL
+    print(f"\n6. Getting app URL...")
+    app_url = f"https://{SNOWFLAKE_ACCOUNT}.snowflakecomputing.com/streamlit/{APP_NAME}"
+    print(f"   âœ“ App URL: {app_url}")
+    
+    cursor.close()
+    conn.close()
+    
+    print("\n" + "=" * 60)
+    print("DEPLOYMENT COMPLETE!")
+    print("=" * 60)
+    print(f"App Name: {APP_NAME}")
+    print(f"App URL: {app_url}")
+    print(f"Stage: @{STAGE_NAME}")
+    print(f"Main File: unified-calculator-app.py")
+    print(f"Packages: matplotlib=3.10.6, seaborn=0.13.2, streamlit=1.35.0")
+    print("\nâœ“ App deployed with package dependencies from environment.yml")
+    print("âœ“ matplotlib and seaborn should now be available for import")
+    print("\nNext steps:")
+    print("1. Access the app via Snowsight: Streamlit â†’ " + APP_NAME)
+    print("2. Or use the URL above")
+    print("3. Verify no ModuleNotFoundError for matplotlib")
+    print("4. Test visualization features to ensure charts render")
+    print("5. Configure Cloudflare DNS if using custom domain")
+    
+    return app_url
+
+if __name__ == "__main__":
+    main()
+
diff --git a/tools/environment.yml b/tools/environment.yml
new file mode 100644
index 0000000..49437f9
--- /dev/null
+++ b/tools/environment.yml
@@ -0,0 +1,7 @@
+name: sf_env
+channels:
+  - snowflake
+dependencies:
+  - streamlit=1.35.0  # Pin to prevent auto-upgrades
+  - matplotlib=3.10.6
+  - seaborn=0.13.2


=== UNSTAGED CHANGES ===
diff --git a/.gitignore b/.gitignore
index 80b809d..8841376 100644
--- a/.gitignore
+++ b/.gitignore
@@ -43,3 +43,8 @@ yarn-error.log
 # Extracted text from PDFs
 /tmp/
 
+.streamlit/secrets.toml
+
+# Snowflake private keys
+rsa_key.pem
+*.pem
